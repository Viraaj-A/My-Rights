{% extends "layout.html" %}
{% block content %}
<head>
    <!-- jqxWidgets CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqwidgets/12.1.0/jqwidgets/styles/jqx.base.css" type="text/css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqwidgets/12.1.0/jqwidgets/styles/jqx.shinyblack.css" type="text/css"/>
    <style>
        /* Override jqxWidgets font to match Bootstrap's default */
        .jqx-widget {
            font-family: inherit !important;
            font-size: inherit !important;
        }
    </style>
</head>

<div class="container">
    <div class="row">
        <div class="col-xs-12">
          <div class="section-container-spacer text-center">
            <h1 class="h2">3 : Text Search</h1>
          </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="row">
        <form action="{{ url_for('results') }}" method="post" data-turbo-frame="results">
            {{ form.hidden_tag() }}
            <div class="row" style="margin-top: 20px;">
                <div class="col-md-8 col-md-offset-2 border">
                    <div class="form-group">
                        {{ form.searched(class="form-control", placeholder="Enter search, for example: protection against tortureIt see") }}
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-6">
                                {{ form.respondent_state(id="respondent_state") }}
                            </div>
                            <div class="col-md-6">
                                {{ form.originating_body(id="originating_body") }}
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-4">
                                {{ form.importance_level(id="importance_level") }}
                            </div>
                            <div class="col-md-4">
                                <div id='jqxdatetimeinput_from'></div>
                                <input type="hidden" name="date_from" id="date_from_hidden">
                            </div>
                            <div class="col-md-4">
                                <div id='jqxdatetimeinput_to'></div>
                                <input type="hidden" name="date_to" id="date_to_hidden">
                            </div>
                        </div>
                    </div>
                    <!-- Row for the buttons -->
                    <div class="row" style="margin-top: 20px;">
                        <div class="col-md-4 col-md-offset-2 text-right">
                            {{ form.semantic_submit(class="btn btn-secondary", value="Concept Search") }}
                        </div>
                        <div class="col-md-4 text-left">
                            {{ form.submit(class="btn btn-secondary", value="Normal Search") }}
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <turbo-frame id="results">
        <div class="row" style="margin-top:40px;">
            <div class="col-md-8 col-md-offset-2 text-center">
                <p>The search could <b>take a few seconds</b> due to the ranking algorithm.</p>
                <p>If you would like further information on how the ranking algorithm works, please go to the <a href="{{ url_for('about') }}">About</a> page.</p>
            </div>
        </div>
    </turbo-frame>
</div>

<!-- jqxWidgets JS -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqwidgets/12.1.0/jqwidgets/jqxcore.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqwidgets/12.1.0/jqwidgets/jqxbuttons.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqwidgets/12.1.0/jqwidgets/jqxscrollbar.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqwidgets/12.1.0/jqwidgets/jqxlistbox.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqwidgets/12.1.0/jqwidgets/jqxcombobox.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqwidgets/12.1.0/jqwidgets/jqxdatetimeinput.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqwidgets/12.1.0/jqwidgets/jqxcalendar.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqwidgets/12.1.0/jqwidgets/globalization/globalize.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        // Init ComboBoxes
        $("#respondent_state").jqxComboBox({ width: '100%', multiSelect: true, autoComplete: true, autoDropDownHeight: true, promptText: "Respondent State" });
        $("#originating_body").jqxComboBox({ width: '100%', multiSelect: true, autoComplete: true, autoDropDownHeight: true, promptText: "Originating Body" });
        $("#importance_level").jqxComboBox({ width: '100%', multiSelect: true, autoComplete: true, autoDropDownHeight: true, promptText: "Importance Level" });

        // Init DateTimeInputs
        $("#jqxdatetimeinput_from").jqxDateTimeInput({ width: '100%', height: '34px', formatString: "yyyy-MM-dd", placeHolder: "From:"});
        $('#jqxdatetimeinput_from').on('change', function (event) {
            var date = event.args.date;
            if (date) {
                $('#date_from_hidden').val(date.toISOString().slice(0, 10));
            } else {
                $('#date_from_hidden').val('');
            }
        });

        $("#jqxdatetimeinput_to").jqxDateTimeInput({ width: '100%', height: '34px', formatString: "yyyy-MM-dd", placeHolder: "To:"});
        $('#jqxdatetimeinput_to').on('change', function (event) {
            var date = event.args.date;
            if (date) {
                $('#date_to_hidden').val(date.toISOString().slice(0, 10));
            } else {
                $('#date_to_hidden').val('');
            }
        });
    });
</script>
{% endblock %}